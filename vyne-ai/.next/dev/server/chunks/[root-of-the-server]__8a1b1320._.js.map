{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/lib/prisma.ts"],"sourcesContent":["\n\nimport { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['error', 'warn'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAEA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/lib/jwt.ts"],"sourcesContent":["// lib/jwt.ts\nimport { SignJWT, jwtVerify, JWTPayload } from \"jose\";\n\nconst encoder = new TextEncoder();\nconst SECRET = encoder.encode(process.env.JWT_SECRET!); // must exist\n\nexport async function signToken(payload: Record<string, any>, expiresIn = \"7d\") {\n  // payload: { id, email }\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setExpirationTime(expiresIn)\n    .sign(SECRET);\n}\n\nexport async function verifyToken(token: string): Promise<JWTPayload> {\n  const { payload } = await jwtVerify(token, SECRET);\n  return payload;\n}\n\n\n\n"],"names":[],"mappings":"AAAA,aAAa;;;;;;;AACb;AAAA;;AAEA,MAAM,UAAU,IAAI;AACpB,MAAM,SAAS,QAAQ,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,GAAI,aAAa;AAE9D,eAAe,UAAU,OAA4B,EAAE,YAAY,IAAI;IAC5E,yBAAyB;IACzB,OAAO,MAAM,IAAI,kKAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,WAClB,IAAI,CAAC;AACV;AAEO,eAAe,YAAY,KAAa;IAC7C,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;IAC3C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport {prisma} from \"@/lib/prisma\";\nimport bcrypt from \"bcryptjs\";\nimport { signToken } from \"@/lib/jwt\";\nimport { cookies } from \"next/headers\";\n\nexport async function POST(req: Request) {\n  const { email, password } = await req.json();\n   const cookieStore =await cookies();\n\n\n  if (!email || !password) {\n    return NextResponse.json({ error: \"Missing fields\" }, { status: 400 });\n  }\n\n  const user = await prisma.user.findUnique({ where: { email } });\n  if (!user) return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\n\n  const valid = await bcrypt.compare(password, user.password);\n  if (!valid) return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 });\n\n  const token = await signToken({ id: user.id, email: user.email }, \"7d\");\n\n  const res = NextResponse.json({ ok: true });\n  cookieStore.set({\n    name: \"token\",\n    value: token,\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    path: \"/\",\n    maxAge: 60 * 60 * 24 * 7,\n  });\n\n  return res;\n}\n\n\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe,KAAK,GAAY;IACrC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IACzC,MAAM,cAAa,MAAM,IAAA,4IAAO;IAGjC,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACtE;IAEA,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE;QAAM;IAAE;IAC7D,IAAI,CAAC,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAsB,GAAG;QAAE,QAAQ;IAAI;IAEpF,MAAM,QAAQ,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;IAC1D,IAAI,CAAC,OAAO,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAsB,GAAG;QAAE,QAAQ;IAAI;IAErF,MAAM,QAAQ,MAAM,IAAA,yHAAS,EAAC;QAAE,IAAI,KAAK,EAAE;QAAE,OAAO,KAAK,KAAK;IAAC,GAAG;IAElE,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;IAAK;IACzC,YAAY,GAAG,CAAC;QACd,MAAM;QACN,OAAO;QACP,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ,KAAK,KAAK,KAAK;IACzB;IAEA,OAAO;AACT","debugId":null}}]
}