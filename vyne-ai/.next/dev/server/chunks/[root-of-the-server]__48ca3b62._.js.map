{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/lib/jwt.ts"],"sourcesContent":["// lib/jwt.ts\nimport { SignJWT, jwtVerify, JWTPayload } from \"jose\";\n\nconst encoder = new TextEncoder();\nconst SECRET = encoder.encode(process.env.JWT_SECRET!); // must exist\n\nexport async function signToken(payload: Record<string, any>, expiresIn = \"7d\") {\n  // payload: { id, email }\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setExpirationTime(expiresIn)\n    .sign(SECRET);\n}\n\nexport async function verifyToken(token: string): Promise<JWTPayload> {\n  const { payload } = await jwtVerify(token, SECRET);\n  return payload;\n}\n\n\n\n"],"names":[],"mappings":"AAAA,aAAa;;;;;;;AACb;AAAA;;AAEA,MAAM,UAAU,IAAI;AACpB,MAAM,SAAS,QAAQ,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,GAAI,aAAa;AAE9D,eAAe,UAAU,OAA4B,EAAE,YAAY,IAAI;IAC5E,yBAAyB;IACzB,OAAO,MAAM,IAAI,kKAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,WAClB,IAAI,CAAC;AACV;AAEO,eAAe,YAAY,KAAa;IAC7C,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;IAC3C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/lib/prisma.ts"],"sourcesContent":["\n\nimport { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['error', 'warn'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAEA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///Users/srijanpatel/Documents/vyne-ai/app/api/auth/signup/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport bcrypt from \"bcryptjs\";\nimport { signToken } from \"@/lib/jwt\";\nimport { prisma } from \"@/lib/prisma\";\n// import { cookies } from \"next/headers\";\n\nexport async function POST(req: Request) {\n  // const cookieStore = await cookies();\n\n  const { email, password } = await req.json();\n\n  if (!email || !password) {\n    return NextResponse.json({ error: \"Missing fields\" }, { status: 400 });\n  }\n  const hashed = await bcrypt.hash(password, 10);\n\n  try {\n    const user = await prisma.user.create({\n      data: { email, password: hashed },\n    });\n\n    const token = await signToken({ id: user.id, email: user.email }, \"7d\");\n\n    const res = NextResponse.json({ ok: true, id: user.id, email: user.email });\n    res.cookies.set(\"token\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      path: \"/\",\n      maxAge: 60 * 60 * 24 * 7, // 7 days\n    });\n    return res;\n  } catch (error) {\n    if (\n      error instanceof Error &&\n      error.message.includes(\"Unique constraint failed\")\n    ) {\n      return NextResponse.json(\n        { error: \"Email already exists\" },\n        { status: 409 }\n      );\n    } else {\n      return NextResponse.json(\n        { error: \"Internal server error\" },\n        { status: 500 }\n      );\n    }\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAGO,eAAe,KAAK,GAAY;IACrC,uCAAuC;IAEvC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;IAE1C,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACtE;IACA,MAAM,SAAS,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;IAE3C,IAAI;QACF,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBAAE;gBAAO,UAAU;YAAO;QAClC;QAEA,MAAM,QAAQ,MAAM,IAAA,yHAAS,EAAC;YAAE,IAAI,KAAK,EAAE;YAAE,OAAO,KAAK,KAAK;QAAC,GAAG;QAElE,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,IAAI,KAAK,EAAE;YAAE,OAAO,KAAK,KAAK;QAAC;QACzE,IAAI,OAAO,CAAC,GAAG,CAAC,SAAS,OAAO;YAC9B,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,IACE,iBAAiB,SACjB,MAAM,OAAO,CAAC,QAAQ,CAAC,6BACvB;YACA,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB,OAAO;YACL,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;IACF;AACF","debugId":null}}]
}